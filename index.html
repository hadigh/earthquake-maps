function loadTimeSeriesData(file, plotId, column) {
    fetch(file)
        .then(response => response.text())
        .then(csvText => {
            let rows = csvText.split("\n").map(row => row.split(","));
            
            // First row is the header, so we skip it
            const header = rows[0];
            const x = rows.slice(1).map(row => row[0]); // Time values (first column, excluding header)

            // Column headers are in the first row, we use the given column index to get the correct column
            let y = rows.slice(1).map(row => {
                let value = parseFloat(row[column]); // Parse the numeric value from the selected column
                if (isNaN(value)) {
                    console.warn(`Skipping non-numeric value: ${row[column]}`); // Log invalid values for debugging
                    return null;
                }
                return value; // Return the parsed value
            }).filter(value => value !== null); // Remove nulls (non-numeric values)

            console.log('Header:', header);  // Debugging: log header
            console.log('Time data:', x);  // Debugging: log time data
            console.log('Velocity data:', y);  // Debugging: log velocity data

            // Find the maximum value and its index
            let maxValue = Math.max(...y);
            let maxIndex = y.indexOf(maxValue);

            // Log the time and value of the max point
            console.log('Max value:', maxValue);
            console.log('Max index:', maxIndex);
            console.log('Max time:', x[maxIndex]);  // Log the time corresponding to the max value

            const trace = {
                x: x,
                y: y,
                mode: 'lines',
                name: 'Time-Series Data'
            };

            // Create a marker for the maximum point
            const maxPoint = {
                x: [x[maxIndex]],
                y: [maxValue],
                mode: 'markers+text',
                marker: {
                    color: 'red',
                    size: 12,
                    opacity: 0.8
                },
                text: [`PGV = ${parseFloat(maxValue).toFixed(2)}`],
                textposition: 'top right',
                showlegend: false
            };

            const layout = { 
                title: 'Corrected Time-Series Data',
                showlegend: false
            };

            // Plot the data with the max point
            Plotly.newPlot(plotId, [trace, maxPoint], layout);
        })
        .catch(error => console.error('Error loading time-series data:', error));
}
